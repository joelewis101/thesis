# Whole genome sequencing of ESBL _E. coli_ carriage isolates
\chaptermark{WGS of ESBL-E}

``` {r ch7-setup, include = F}

wd <- "chapter_7/"

# and packages
library(tidyverse)
library(reshape2)
library(knitr)
library(kableExtra)
library(grid)
library(ggpubr)
library(ggtree)

 parse_checkm_lines <- function(s, n) {
  strsplit(s, " ") -> stemp
  stemp <- stemp[[1]][stemp[[1]] != ""] 
  stemp <- c(stemp[1], paste0(stemp[2],"_", stemp[3]), stemp[4:15])
  names(stemp) <- n
  return(stemp)
 }


output = "latex"


```
## Chapter overview

This chapter describes the use of whole-genome sequencing (WGS) of ESBL producing _E. coli_ to understand the drivers of gut mucosal ESBL-E carriage. I will begin with a description of the genomic landscape of the isolates form this study: starting with simple descriptions of _E. coli_ phylogroup and multilocus sequence type (MLST) I will place the isolates from this study in the context of the _E. coli_ population, followed by higher-resolution contextulaistaion using phylogenetics to place isolates from this study in the context of a global _E. coli_ collection. I will describe the genetic basis of antimicrobial resistance in these isolates and explore the extent to which AMR genes tend to cluster together beyond what would be expected by chance. Finally, I will attempt to use the resolution offered by WGS to attempt to answer two specific questions: firstly, what is the mechanism of rapid increase in ESBL-E carriage prevalence following hospital admission and antimicrobial exposure we see in this study? Secondly, what is the likely unit of ESBL-E transmission in this study? Are bacteria, or mobile genetic elements (MGE) implicated? And if, MGE, which: plasmids, transposons, integrons - or a combination?

These questions, phrased in this way, seem difficult or impossible to answer given the available WGS data, but by slightly reframing them they become tractable: first, what is the diversity of apparent hospital-acquired ESBL _E. coli_ in comparison to apparent community-acquired isolates? Apparent hospital acquisitions could represent true acquisitions of, for example, a hospital-associated clone - but equally they could be an "unmasking" of minority variant _E. coli_ in the microbiota, acquired in the community but not detected by culture because of low abundance, until enriched for by antimicrobial exposure. If the diversity of apparently hospital aquired isolates is contained within the diversity of community isolates, this would lend support to this latter hyothesis. The second question - what is the unit of transmission in this system - can be reframed by asking: what is the unit that is most conserved within patients, as compared to between patients?  The questions then reduce to a dimensionality redcution problem: in order to address them both, it is necessary to classify either bacteria or MGE into mutually exclusive categories, in order to compare hospital to community isolates, and between-patient to within-patient. I describe the approach I have taken to this below. 

## Methods

### Bioinformatic pipeline

The basic bioinformatic pipeline used is described in detail in Chapter 2, methods. Briefly, one _E. coli_ colony from each patient sample was taken forward for DNA extraction and paired-end short-read whole genome sequencing using Illumina HiSeq X at the Wellcome Sanger Institute. Read quality control was undertaken with Kraken[@Wood2014] v0.10.6 to assign reads to species and WSI QC pipeline which maps a random 100 Mbases fron each sample to a reference and calculates depth of coverage, number of heterogeneous SNPs, GC content and insert size. Samples that contained > 20% non _E coli._ reads were discarded and _de novo_ assembly was undertaken with SPAdes[@Bankevich2012a] v3.11.0. Assembly statistics were calculated with QUAST[@Gurevich2013] v4.6.0 and completeness and contamination of the assemblies assessed by checkM[@Parks2015] v1.0.7. Contaminated assemblies (with checkM-defined contamination of > 25%) or poor assemblies (with N50 < xxx) were discarded. Annotation was carried out with Prokka[@Seemann2014a] v1.5 with a genus specific database from RefSeq and the Roary v1.007 pan-genome pipeline[@Page2015] was used to construct a core genome. A core gene multiple sequence alignment was generated using maaft[@Katoh2013] v7.205, SNP-sites identified using SNP-sites[@Page2016] v2.4.1 and the resultant SNP alignment used to build a maximum likelihood phylogenetic tree using IQ-TREE[@Nguyen2015] v1.6.3, using ascertainment bias correction to correct for the fact that the input pseudosequence contained only variable sites, and using the ModelFinder module used to find the best fitting nucleotide substition model. This calculates the likeliood of a number of different models and chooses the model with the lowest (best fitting) Bayesian Information Criterion, a statistic which penalises model parameters. Reliability of inferred branch partitions was assessed with 1000 bootstrap replicates. Trees were visualised in the ggtree v1.14.4 package[@Yu2017] in R. 

Ariba[@Hunt2017a] v2.12.1 was used to identify AMR-associated genes using the SRST2[@Inouye2014] database, to identify plasmid replicons using the PlasmidFinder database[@Carattoli2014] and to perform _in silico_ muli-locus sequence typing (MLST) using the database from http://mlst.warwick.ac.uk/mlst/dbs/Ecoli accessed via www.pubmlst.org. Because quinolone resistance often results from SNPs in the chromasome in the quinolone resistance determining regions (QRDRs) of the _gyrA_, _gyrB_, _parE_ and _parC_ genes - rather than acquisition of whole AMR-determining genes, as is the case with the other genes sought by Ariba - these genes were downloaded from the comprehensive antimicrobial resistance database (CARD, https://card.mcmaster.ca/) and Ariba used to call SNPs in them, with default settings. _E. coli_ phylogrouping was performed with a quadruplex _in silico_ PCR using the Clermont scheme[@Clermont2013] and isPcr v33x2 (https://github.com/bowhan/kent/tree/master/src/isPcr) 

Rhierbaps package v1.1.0 in R[@Cheng2013] was used to cluster the core genome pseudosequence into sequence clusters (SCs). Two levels were used and these level 2 clusters used to test associations (see statistical analysis, below). To track putative mobile genetic elements ESBL-gene containing contigs were identified using BLASTn[@Altschul1990] v2.7.0 of all contigs against the SRST2 database and then contigs containing any given ESBL gene  were grouped by the ESBL gene they contained (for example, all $bla_{ctxm15}$ gene-containing clusters were grouped together), and each group clustered using cd-hit[@Li2006] v4.6 to produce mutually exclusive ESBL-gene-containing contig clusters for each identified ESBL gene. Henceforth, these clusters will be referred to as ESBL-clusters, for brevity. In order to attempt to determine the biological significance of the identified ESBL-clusters (i.e. what kind of MGE element they are likely to represent), basic statistics were plotted (number of samples contained withing each cluster, length of longest contig in cluster in kbases, length distribution of all contigs is cluster relative to longest contig and distribution of sequence identity compared to the longest contig in the cluster). Presence of compound trasposons, AMR determinents and plasmid replicons were identified by using BLAST with default settings of each ESBL-cluster representative sequence (as determined by cd-hit i.e one, the longest, for each ESBL-cluster) against the insertion sequence finder (ISfinder) database and the SRST2 database, taking the top hit (as determined by bitscore) for any given location, and visualising the results in gggenes v0.3.2. To assess lineage association, the ESBL-clusters were mapped back to the core genome SNP tree. 

### Global _E. coli_ collection

In order to place the isolates from this study in a global context, published _E. coli_ assemblies were downloaded from the WSI servers. These included 149 ESBL-producing _E. coli_ from a single centre study in Chachoengsao province, eastern Thailand[@Runcharoen2017]. In this study, human clinical isolates from standard care in Bhuddhasothorn hospital were selected on the basis of the ESBL phenotype, and environmental samples were collected as part of a cross sectional study and selectively cultured for ESBL-E in 2014-2015. I also downloaded assemblies of 362 enterotoxogenic _E. coli_ (ETEC), selected for an ETEC genomic study from the Gothenburg University ETEC collection to represent a broad collection of ETEC isolated worldwide from 1980-2011[@VonMentzer2014]; 185 atypical enteropathogenic _E. coli_ (aEPEC) sequenced for a study of aEPEC and selected from samples frrm the Global Enteric Multicentre Study (GEMS) in seven centres in Africa and Asia between 2007-2011[@Ingle2016]; and 94 _E. coli_ from QECH in Blantyre, Malawi, a combination of invasive (bloodstream and CSF) and carriage isolates, selected for diversity in AMR phenotype from 1996-2014[@Musicha2017]. Details of the year, sample andcountry of isolation for these samples are given in the appendix to this chapter.

### Statistical analysis

In order to explore clustering of AMR genes, the Jaccard index was calculated for a given AMR-gene pair using he Jaccard v0.1.0 package in R. The Jaccard index, a measure of the similarity of two sets of data, is defined as _intersection over union_; in this context, for a given pair of AMR genes $x$ and $y$, the Jaccard index $J(x,y)$ is the number of isolates that contain both gene $x$ and $y$ divided by the total number that contain either $x$ or $y$:

$$J(x,y) = \displaystyle \frac{| x \cap y |}{| x \cup y| }$$

By definition it lies between 0 ($x$ and $y$ never co-occur) and 1 ($x$ and $y$ always co-occur). Co-occurance matrices using the Jaccard index were plotted using the pheatmap v 1.0.12 package in R. The statistical significance of co-occurance of genes was assessed by generating 2x2 contingency tables for a given gene pair and p values generated using a Fisher's test with Bonferroni correction; a p value of less that 0.05 was considered statistically significant. Co-occurance networks of genes occuring commonly together (defined as Jaccard index > 0.5) at a rate greater than expected by chance (p < 0.05 following Bonferroni correction) and uncommonly occuring together (defined as Jaccard index < 0.1 and p < 0.05 following Bonferroni correction) were plotted using igraph v1.2.2 and ggraph v1.0.2 in R.

To explore hospital or community associations of any given _E. coli_ clade, the location of isolation was first plotted against the phylogenetic tree; location of isolation was classified as hospital, community, or recent hospital discharge (defined as a date of isolation within 2 weeks of hospital discharge). This latter category was used because it is possible that a patient could acquire an ESBL-E clone in hospital but only be sampled once leaving hospital; using only hospital isolated and community isolted categories could therefore introduce bias. Hospital or community association of each sequence cluster was assessed using a Fisher's test of proportion of hospital associated samples (defined as sum of hospital isolated and recent hospital discharge) for the given sequence cluster as compared to proportion of hospital associated samples in the remainder of the samples, with a Bonferroni correction for multiple comparisons. p < 0.05 was again considered statistically significant.

To compare within-patient to between-patient conservation of bacteria (as represented by core genome alignment and sequence cluster) and ESBL-containing MGE (as represented by the ESBL-clusters) several approaches were taken. Firstly, I assessed whether either sequence cluster or ESBL-cluster were conserved within an individual at all. I hypothesised that any within-patient correlation is likely to be a function of time: samples closer together in time may be more likely to be similar. To assess if this was the case for bacteria, pairwise core genome pseudosequence SNP distance was was calculated using snp-dists v0.4 (https://github.com/tseemann/snp-dists) for all samples and plotted against the time difference (in days) between samples, within and between patients, and with a smoothed curve fitted using a general additive model with cubic splines. Because of significant overplotting, this was also plotted as a 2D density plot. Based on these plots, the within and between patient SNP distances were compared in two post-hoc defined groups binned by time distance between the samples (50 days or less vs. more than 50 days), and distributions compared with Kruskal-Wallace tests.

I then compared the within patient temporal clustering of ESBL-clusters and sequence clusters, by estimating the proportion of within-patient samples that contain the same ESBL-cluster or sequence cluster, as a function of time; essentially a temporal autocorrelation function. To estimate this, I considered pairwise comparsion of all within-patient samples. For any given time between samples, $t$ I defined a window of +/-5 days and estimated the probabilities as the number of all within-patient sample pairs in the window $[t - 5, t+5]$ that contained the same sequence cluster or ESBL-cluster divided by the total number of all within-patient sample pairs within that time window. Exact binomial confidence intervals for these proportions were generated and probabilities plotted as a function of time. In order to estimate the probability of two samples containing the same sequence cluster of contig-cluster purely by chance, 1000 sample pairs were randomly drawn from all samples with replacement and the proportion of these samples that contained the same sequence cluster or ESBL-cluster calculated.

Finally, to inform the question as to what the likely unit of transmission in this system is, I assessed what was most conserved within patients, in pairwise sample comparison: bacteria (as represented by core gene sequence cluster), ESBL-containing MGE (as represented by ESBL-cluster), or both. Simple proportions in all-against-all pairwise comparison - stratified by whether between-patient or within-patient - were calculated: the proportion of samples that contain the same core gene sequence cluster only, the proportion of samples contain the same ESBL-cluster only, and the proportion that contain both sequence cluster and ESBL-cluster. Proportions were compared between within and between-patient strat in these three groups using Fisher's exact test, with p < 0.05 considered statistically significant.

## Results

### Samples and quality control

In total, 520 _E. coli_ underwent DNA extraction and were shipped from Malawi to WSI; these represented all sequential isolates at the time of final DNA extraction, which occured in two batches in February 2018 and October 2018. Kracken/Bracken read assignment of these samples is shown in Figure \@ref(fig:wgs-qc-braken). The majority of samples have > 90% or reads assigned to _E. coli_; a minority have < 90% of reads assigned to _E. coli_ but a very closely related species such as _Shigella_, amd as such are likely to be pure _E. coli_ culture with read misclassification. However, 12 samples have > 80% reads assigned to a non- _E. coli_ species such as _Klebsiella pneumoniae_. These samples were assumed to represent upstream species misidentification or, perhaps more likely, selection of the wrong sample from the freezer archive for culture and DNA extraction, given that for any sample ID there are often several bacterial species identified and cryopreserved. These samples were excluded from further analysis.

```{r wgs-qc-braken,  echo = F, warning = F, message = F, fig.scap="Kraken/bracken read assignment", out.extra='', fig.cap= "Read assignment by Kracken and Bracken of all samples", fig.align= "center",fig.height = 10, fig.width = 6 }

df1 <- read_tsv(paste0(wd, "D1_Braken_readscreen_species_composition.tsv"))
df2 <- read_tsv(paste0(wd, "D2_Bracken_species_composition.tsv"))
df3 <- read_tsv(paste0(wd, "D2_extra_krakenout_species_composition_16.tsv"))

df.brac <- bind_rows(df1, df2, df3)
df.brac[is.na(df.brac)] <- 0

melt(df.brac, id.vars = "name") -> dftemp

dftemp$variable <- factor(dftemp$variable, levels = unique(dftemp$variable[order(as.character(dftemp$variable))]))

dftemp$name <- factor(dftemp$name, levels = df.brac$name[order(df.brac$`Escherichia coli`, decreasing = T)])

ggplot(dftemp, aes(name, value, fill = variable)) + geom_col() + coord_flip() + scale_fill_brewer(palette = "Paired") + theme(axis.text.y = element_text(size = 3), legend.title = element_blank()) + labs(x= "Sample ID", y = "% reads" ) 


```

```{r wgs-load-qc,  echo = F, warning = F, message = F}

# load sanger QC

df1 <- read.csv(paste0(wd, "5341.pathfind_stats.csv"), stringsAsFactors = F)
df2 <- read.csv(paste0(wd, "5510.pathfind_stats.csv"), stringsAsFactors = F)

#df2$`No. Het SNPs`<- as.numeric(df2$`No. Het SNPs`)

df.qc <- rbind(df1, df2)


# laod checkM

con <- file(paste0(wd, "checkm_quast/D1/checkm.report"))
lines <- readLines(con)
close(con)

con <- file(paste0(wd, "checkm_quast/D220190318/checkm.report"))
lines2 <- readLines(con)
close(con)

con <- file(paste0(wd, "checkm_quast/D220190503/checkm.report"))
lines3 <- readLines(con)
close(con)

# line 2 has headings - get em
strsplit(lines[[2]]," ") -> heads
heads[[1]][heads[[1]] != "" & heads[[1]] != "#"] -> heads

# sigh
heads <- c(paste0(heads[1], "_", heads[2]), paste0(heads[3], "_", heads[4]), heads[5:6],
           paste0(heads[7],"_",heads[8]), heads[9:16], paste0(heads[17], "_", heads[18]))

lines <- lines[-c(1,2,3, length(lines))]
lines2 <- lines2[-c(1,2,3, length(lines2))]
lines3 <- lines3[-c(1,2,3, length(lines3))]
 
 

lines <- lapply(lines, parse_checkm_lines, heads)
lines2 <- lapply(lines2, parse_checkm_lines, heads)
lines3 <- lapply(lines3, parse_checkm_lines, heads)

lines <- data.frame(do.call(rbind, lines))
lines2 <- data.frame(do.call(rbind, lines2))
lines3 <- data.frame(do.call(rbind, lines3))

lines <- rbind(lines, lines2, lines3)
rm(lines2)
rm(lines3)
lines[3:ncol(lines)] <- sapply(lines[3:ncol(lines)], function(x) as.numeric(as.character(x)))

names(lines)[names(lines) == "Bin_Id"] <- "Assembly"

#sub( "_1_", "_1#", q$Assembly) -> q$Assembly
sub(".contigs_spades", "", lines$Assembly) -> lines$Assembly

checkm <- lines
rm(lines)

## and quast
rbind(
  read.delim(paste0(wd, "checkm_quast/D1/transposed_report.tsv"), stringsAsFactors = F ),
  read.delim(paste0(wd, "checkm_quast/D220190318/transposed_report.tsv"), stringsAsFactors = F ),
  read.delim(paste0(wd, "checkm_quast/D220190503/transposed_report.tsv"), stringsAsFactors = F )
  ) -> quast

for (i in 1:10) {
sub("\\.", "", names(quast)) -> names(quast)
}

sub(".contigs_spades","", quast$Assembly) -> quast$Assembly
sub("_1_","_1#", quast$Assembly) -> quast$Assembly
sub("_2_","_2#", quast$Assembly) -> quast$Assembly

df.qc <- merge(df.qc, df.brac, by.x = "Lane.Name", by.y = "name", all.x = T)
df.qc <- merge(df.qc, checkm, by.x = "Lane.Name", by.y = "Assembly", all.x = T)
df.qc <- merge(df.qc, quast, by.x = "Lane.Name", by.y = "Assembly", all.x = T)

# remove non ESCO

df.qc <- subset(df.qc, `Escherichia coli` > 20)


```

Of the remaining 508 samples, there were a median (IQR) of `r paste0(median(df.qc$Reads), " (", quantile(df.qc$Reads, 0.25)[[1]], "-", quantile(df.qc$Reads, 0.75)[[1]], ")")` reads, with a median (IQR) depth of coverage (obtained by mapping a random 100Mbases to a refernce _E. coli_ genome, Escherichia coli strain K-12 substrain MG1655, NCBI reference NC_000913.3) of `r paste0(round(median(df.qc$Depth.of.Coverage)), " (", round(quantile(df.qc$Depth.of.Coverage, 0.25)[[1]]), "-", round(quantile(df.qc$Depth.of.Coverage, 0.75)[[1]]), ")")`. One sample had an order of magnitude lower number of reads (291556) with depth of coverage 0; this was assumed to represent sequencing failure and it was excluded from further analysis.

The output from quast and checkM are shown in Figure \@ref(fig:wgs-qc), where N50 (the minimum contig length upon which at least half assembled bases are contained) is plotted as a function of total assembled length. The expected _E. coli_ genome length is around 4.6Mb and most samples cluster close to this at a total assembled length of ~ 5Mb. Howvever it is clear that some assemblies  have failed, with low N50 and low assembled length. It is also apparent that some samples seem to be contaminated, as indicated by low N50 and much longer than expected total assembled length. Defining assembly failure as < 1Mb assembled length (triangles in the plot, n = 9) and contamination as checkM-defined contamination of > 25% (blue points in the plot, n = 24) and excluding both groups results in 33 further samples being excluded from further analysis.

In total, therefore, 46/520 (11%) of samples which were submitted for sequencing were excluded from downstream analysis. The remaining 474 samples represent 69% (474/686) of the cutured _E. coli_ in this study; 354 are from patients with sepsis, 86 are from hospitalised inpatients and 33 are from community members, with a median of 2 (range 1-5) samples per participant. N50, total assembled length and number of assembled contigs are shown in the appendix to this chapter.

```{r wgs-qc, echo = F, warning = F, message = F, fig.scap="N50 as a function of total assembly length", fig.cap= "N50 as a function of total assembled length. Failed assemblies with less than 1Mb assembled shown as triangles. Contaminated assemblies with checkM-defined contamination above 25\\% shown in blue." }

df.qc <- subset(df.qc, Reads > 300000)

ggplot(df.qc, aes(Totallength, N50, colour = Contamination > 25, shape = Xcontigs < 10)) + geom_point() + theme_bw() + labs(shape = "< 1Mb assembled", colour = "Contamination > 25%", x = "Total assembled length (bp)") 

```

```{r wgs-mlst-pgroup, echo = F, warning = F, message = F }

mlst <- read_csv(paste0(wd, "phylogroup_and_mlst/mlst.csv"))
pgroups <- read_csv(paste0(wd, "phylogroup_and_mlst/phylogroups.csv"))
```

### Phylogroup, MLST and core genome phylogeny of study isolates

The commonset _E. coli_ phylogroup was phylogroup A: 204/473 (43%) samples belonged to phylogroup A, followed by phylogroup B2 (96/473 [20%]), F (53/473 [11%]), B1 (43/473 [9%]) and C (43/473 [9%]) and D (26/473 [5%]). Two samples were Clade I or II (so called cryptic clades) and 6/473 (1%) were unknown phylogroup using the Clermont PCR scheme. In the MLST analysis, 56 recognised sequence types (STs) were identified, and 12 samples were novel STs; however over half (249/473 [53%]) of samples were represented by the top seven most frequent STs (Figure \@ref(fig:wgs-mlst)). ST131 was the most commonly isolated sequence type (64/473 [14%] of isolates) followed by ST410 (45/473 [10%] of isolates) and ST167 (38/473 [8%] of isolates).

The Roary pan-genome pipeline identified a core genome in the study isolates of 2966 genes, with a pan-genome of 26840 genes. The resultant core gene pseudosequence of length 1388742 bases contained 99693 variable sites, which were used to infer the maximum likelihood phylogenetic tree. The IQTREE ModelFinder module determined that a general time reversible (GTR) model with FreeRate site heterogeneity with 5 parameters provided the best fit to the data. The inferred tree is shown in Figure \@ref(fig:wgs-mlst) along with isolate phylogroup and sequence types; in general, as expected, sequence types were largely monophyletic and phylogroups tended to cluster together.

```{r wgs-mlst, echo = F, warning = F, message = F, fig.cap="\\textit{E. coli} sequence type distribution", fig.height = 5, fig.width=5}

ggplot(mlst, aes(fct_infreq(ST))) + geom_bar() + coord_flip()  +
  xlab("E. coli sequence type") + ylab("Count") + theme(axis.text=element_text(size=6))

```


```{r wgs-tree, echo = F, warning = F, message = F, fig.scap="ML phylogenetic tree of study \\textit{E. coli}", fig.cap="Maximum likelihood phylogenetic tree of included study \\textit{E. coli} isolates showing phylogroups and sequence types. Bootstrap support of less than 90\\% is indicated by a black circle at a given node. Scale bar indicates 0.01 SNPs/site.", fig.height = 10, fig.width=8}


rownames(pgroups) <- pgroups$Lane
dcast(mlst, lane ~ ST, fun.aggregate = length) -> mlst.onehot
#mlst.onehot <- subset(mlst.onehot, lane %in% tree$tip.label)

rownames(mlst.onehot) <- mlst.onehot$lane
mlst.onehot <- select(mlst.onehot, -lane)
n.mlsts <- sort(apply(mlst.onehot,2, sum), decreasing = T)
mlst.onehot[names(n.mlsts[n.mlsts > 1])] -> mlst.onehot

apply(mlst.onehot, 1, sum) == 0 -> mlst.onehot$other
mlst.onehot$other<- as.numeric(mlst.onehot$other)



mlst.onehot[mlst.onehot == 0] <- "Z_No"
mlst.onehot[mlst.onehot == 1] <- "Z_Yes"






#mlst.onehot[c(sort(as.numeric(names(mlst.onehot)[names(mlst.onehot) != "Novel"])), "Novel")] -> mlst.onehot


col <- c(hue_pal()(8), "lightgrey", "black")
names(col) <- c("A","B1","B2","C","Clade I or II", "D","F", "Unknown", "Z_No", "Z_Yes")

ggtree(tree) %>% gheatmap(select(pgroups, Phylogroup), font.size = 3, width = 0.1, 
                          colnames_position = "top", color = NA, colnames_offset_y = 5) +
  scale_fill_manual(values =col, labels = c("A","B1","B2","C","Clade I/II", "D","F", 
                                            "Unknown", "Absent", "Present"))-> p1x

leg1 <- get_legend(p1x)

ggtree(tree) %>% gheatmap(select(pgroups, Phylogroup), width = 0.1, 
                          color = NA, font.size = 4, colnames_angle = 90,
                          colnames_position = "top", colnames_offset_y = 30)  %>% gheatmap((mlst.onehot), font.size = 2.5, color = NA, 
                          colnames_angle = 90, offset=.03, colnames_offset_y = 10, colnames_position = "top",)  + geom_treescale(x =0, y = 0, offset = 5)  +   geom_point2(aes(subset = as.numeric(label) < 90 & !isTip), size = 1) + theme(legend.position = "none") +
  scale_fill_manual(values =col, labels = c("A","B1","B2","C","Clade I or II", "D","F", 
                                            "Unknown", "Absent", "Present")) + annotate("text", x= 0.28, y =510, label = "Sequence Type") -> p

plot_grid(p, leg1, ncol = 2, rel_widths = c(1,0.1))


```


### Study isolates in a global context

### Antimicrobial resistance determinents

### Clustering core gene alignment and MGE
## Appendix